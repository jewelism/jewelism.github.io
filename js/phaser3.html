<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Phaser3 | Jewelry Blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-NG6SBMZL');</script>
    <link rel="icon" href="/images/logo.png">
    <meta name="description" content="dev blog">
    <meta property="og:title" content="Jewelry Blog">
    <meta property="og:description" content="dev blog">
    <meta name="naver-site-verification" property="naver-site-verification" content="5b2f37c7b4199869388745a2b48d71230f79701b">
    
    <link rel="preload" href="/assets/css/0.styles.7b19a011.css" as="style"><link rel="preload" href="/assets/js/app.d8edd250.js" as="script"><link rel="preload" href="/assets/js/2.b813d316.js" as="script"><link rel="preload" href="/assets/js/1.63ec6906.js" as="script"><link rel="preload" href="/assets/js/115.49ad11c7.js" as="script"><link rel="prefetch" href="/assets/js/10.68915e8a.js"><link rel="prefetch" href="/assets/js/100.d48fb8d1.js"><link rel="prefetch" href="/assets/js/101.b5ebbd9c.js"><link rel="prefetch" href="/assets/js/102.982f90cb.js"><link rel="prefetch" href="/assets/js/103.c96dc806.js"><link rel="prefetch" href="/assets/js/104.f1a3e6c7.js"><link rel="prefetch" href="/assets/js/105.bee66f51.js"><link rel="prefetch" href="/assets/js/106.d4e221ac.js"><link rel="prefetch" href="/assets/js/107.17fa7b87.js"><link rel="prefetch" href="/assets/js/108.036293f3.js"><link rel="prefetch" href="/assets/js/109.f902e0bc.js"><link rel="prefetch" href="/assets/js/11.90e8c648.js"><link rel="prefetch" href="/assets/js/110.23cf18f3.js"><link rel="prefetch" href="/assets/js/111.25a08651.js"><link rel="prefetch" href="/assets/js/112.b575ba09.js"><link rel="prefetch" href="/assets/js/113.39d46774.js"><link rel="prefetch" href="/assets/js/114.54b1d77d.js"><link rel="prefetch" href="/assets/js/116.d1eb4002.js"><link rel="prefetch" href="/assets/js/117.641cbc64.js"><link rel="prefetch" href="/assets/js/118.8c20b0ee.js"><link rel="prefetch" href="/assets/js/119.5e1499c4.js"><link rel="prefetch" href="/assets/js/12.566e820c.js"><link rel="prefetch" href="/assets/js/120.bd6dbcbf.js"><link rel="prefetch" href="/assets/js/121.fdb8d482.js"><link rel="prefetch" href="/assets/js/122.2b358183.js"><link rel="prefetch" href="/assets/js/123.47da7d6f.js"><link rel="prefetch" href="/assets/js/124.25f4b64b.js"><link rel="prefetch" href="/assets/js/125.3600f35d.js"><link rel="prefetch" href="/assets/js/126.bf9c3ab6.js"><link rel="prefetch" href="/assets/js/127.2a668d3c.js"><link rel="prefetch" href="/assets/js/128.f6e7d7a4.js"><link rel="prefetch" href="/assets/js/129.de543284.js"><link rel="prefetch" href="/assets/js/13.7d78815a.js"><link rel="prefetch" href="/assets/js/130.b8eb138d.js"><link rel="prefetch" href="/assets/js/131.df799559.js"><link rel="prefetch" href="/assets/js/132.87f8fdd2.js"><link rel="prefetch" href="/assets/js/133.1ecedbc9.js"><link rel="prefetch" href="/assets/js/134.050b3131.js"><link rel="prefetch" href="/assets/js/135.67fab777.js"><link rel="prefetch" href="/assets/js/136.5606edf6.js"><link rel="prefetch" href="/assets/js/137.e66661fb.js"><link rel="prefetch" href="/assets/js/138.f9436bbb.js"><link rel="prefetch" href="/assets/js/139.8ea1d596.js"><link rel="prefetch" href="/assets/js/14.a384c04f.js"><link rel="prefetch" href="/assets/js/140.ac02ebc5.js"><link rel="prefetch" href="/assets/js/141.14b29649.js"><link rel="prefetch" href="/assets/js/142.e57ed7db.js"><link rel="prefetch" href="/assets/js/143.06f2348c.js"><link rel="prefetch" href="/assets/js/144.a54de9c0.js"><link rel="prefetch" href="/assets/js/145.8714c371.js"><link rel="prefetch" href="/assets/js/146.afd802e8.js"><link rel="prefetch" href="/assets/js/15.5581965d.js"><link rel="prefetch" href="/assets/js/16.36a6df8c.js"><link rel="prefetch" href="/assets/js/17.58419ce3.js"><link rel="prefetch" href="/assets/js/18.78334840.js"><link rel="prefetch" href="/assets/js/19.31ca3599.js"><link rel="prefetch" href="/assets/js/20.55945dbc.js"><link rel="prefetch" href="/assets/js/21.6ddb8d2b.js"><link rel="prefetch" href="/assets/js/22.8d390135.js"><link rel="prefetch" href="/assets/js/23.5d48bf66.js"><link rel="prefetch" href="/assets/js/24.98a3f2a7.js"><link rel="prefetch" href="/assets/js/25.58157085.js"><link rel="prefetch" href="/assets/js/26.f12be7ca.js"><link rel="prefetch" href="/assets/js/27.8b47009c.js"><link rel="prefetch" href="/assets/js/28.94f9feb0.js"><link rel="prefetch" href="/assets/js/29.5b7d2648.js"><link rel="prefetch" href="/assets/js/3.333fb557.js"><link rel="prefetch" href="/assets/js/30.705c0baa.js"><link rel="prefetch" href="/assets/js/31.fdb59e0f.js"><link rel="prefetch" href="/assets/js/32.2383a55b.js"><link rel="prefetch" href="/assets/js/33.bfbec105.js"><link rel="prefetch" href="/assets/js/34.69f76c89.js"><link rel="prefetch" href="/assets/js/35.9f0aa7e6.js"><link rel="prefetch" href="/assets/js/36.02beee59.js"><link rel="prefetch" href="/assets/js/37.19802134.js"><link rel="prefetch" href="/assets/js/38.5653c840.js"><link rel="prefetch" href="/assets/js/39.e3b746fa.js"><link rel="prefetch" href="/assets/js/4.95c43ca0.js"><link rel="prefetch" href="/assets/js/40.96d79a78.js"><link rel="prefetch" href="/assets/js/41.268c3897.js"><link rel="prefetch" href="/assets/js/42.2339675a.js"><link rel="prefetch" href="/assets/js/43.826b5267.js"><link rel="prefetch" href="/assets/js/44.7eabcb79.js"><link rel="prefetch" href="/assets/js/45.e9a3bb83.js"><link rel="prefetch" href="/assets/js/46.7a822972.js"><link rel="prefetch" href="/assets/js/47.5e9b258d.js"><link rel="prefetch" href="/assets/js/48.6db42384.js"><link rel="prefetch" href="/assets/js/49.99deed78.js"><link rel="prefetch" href="/assets/js/5.9d9e1e88.js"><link rel="prefetch" href="/assets/js/50.7829d7c4.js"><link rel="prefetch" href="/assets/js/51.9941a5c2.js"><link rel="prefetch" href="/assets/js/52.c528219a.js"><link rel="prefetch" href="/assets/js/53.b486f5b8.js"><link rel="prefetch" href="/assets/js/54.3590e606.js"><link rel="prefetch" href="/assets/js/55.3f5aa439.js"><link rel="prefetch" href="/assets/js/56.d22c590b.js"><link rel="prefetch" href="/assets/js/57.af5f42f5.js"><link rel="prefetch" href="/assets/js/58.b12ffd2f.js"><link rel="prefetch" href="/assets/js/59.32c30e64.js"><link rel="prefetch" href="/assets/js/60.e8005a21.js"><link rel="prefetch" href="/assets/js/61.322cf604.js"><link rel="prefetch" href="/assets/js/62.c11f3a96.js"><link rel="prefetch" href="/assets/js/63.c5506d7b.js"><link rel="prefetch" href="/assets/js/64.0d80102d.js"><link rel="prefetch" href="/assets/js/65.dfb2d864.js"><link rel="prefetch" href="/assets/js/66.370ef41d.js"><link rel="prefetch" href="/assets/js/67.88c9e001.js"><link rel="prefetch" href="/assets/js/68.f338a0d2.js"><link rel="prefetch" href="/assets/js/69.bdb4c5b0.js"><link rel="prefetch" href="/assets/js/70.c38e5f80.js"><link rel="prefetch" href="/assets/js/71.88270db3.js"><link rel="prefetch" href="/assets/js/72.dcd32982.js"><link rel="prefetch" href="/assets/js/73.58f68dab.js"><link rel="prefetch" href="/assets/js/74.4ada683a.js"><link rel="prefetch" href="/assets/js/75.a6d32488.js"><link rel="prefetch" href="/assets/js/76.c0d0c351.js"><link rel="prefetch" href="/assets/js/77.5c46677d.js"><link rel="prefetch" href="/assets/js/78.d2e954df.js"><link rel="prefetch" href="/assets/js/79.737ec5f0.js"><link rel="prefetch" href="/assets/js/8.ca781c48.js"><link rel="prefetch" href="/assets/js/80.5d71fe19.js"><link rel="prefetch" href="/assets/js/81.217ef913.js"><link rel="prefetch" href="/assets/js/82.7362843c.js"><link rel="prefetch" href="/assets/js/83.5e90d306.js"><link rel="prefetch" href="/assets/js/84.4420de65.js"><link rel="prefetch" href="/assets/js/85.473092ef.js"><link rel="prefetch" href="/assets/js/86.04701726.js"><link rel="prefetch" href="/assets/js/87.83273b43.js"><link rel="prefetch" href="/assets/js/88.676b6f5c.js"><link rel="prefetch" href="/assets/js/89.9ba0b94d.js"><link rel="prefetch" href="/assets/js/9.13b3374f.js"><link rel="prefetch" href="/assets/js/90.eb51ebaa.js"><link rel="prefetch" href="/assets/js/91.7b0c3d93.js"><link rel="prefetch" href="/assets/js/92.af3e1247.js"><link rel="prefetch" href="/assets/js/93.776e9706.js"><link rel="prefetch" href="/assets/js/94.43b48ebf.js"><link rel="prefetch" href="/assets/js/95.ba8e4bc1.js"><link rel="prefetch" href="/assets/js/96.2fa5d3a3.js"><link rel="prefetch" href="/assets/js/97.1c4f3144.js"><link rel="prefetch" href="/assets/js/98.0c7cbaa6.js"><link rel="prefetch" href="/assets/js/99.b171f0e5.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.73bb25e3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7b19a011.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name" style="margin-left:15px;">Jewelry Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/js" class="sidebar-heading clickable router-link-active open"><span>Javascript</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/Array.prototype.html" class="sidebar-link">Array.prototype</a></li><li><a href="/js/String.prototype.html" class="sidebar-link">String.prototype</a></li><li><a href="/js/arguments.html" class="sidebar-link">arguments</a></li><li><a href="/js/array-like.html" class="sidebar-link">유사배열</a></li><li><a href="/js/arrow_function.html" class="sidebar-link">화살표함수</a></li><li><a href="/js/async-await.html" class="sidebar-link">async, await</a></li><li><a href="/js/closure.html" class="sidebar-link">클로져</a></li><li><a href="/js/coding-tips.html" class="sidebar-link">코딩 가이드 &amp; 팁</a></li><li><a href="/js/constructor.html" class="sidebar-link">생성자</a></li><li><a href="/js/core.html" class="sidebar-link">자바스크립트 코어</a></li><li><a href="/js/es6.html" class="sidebar-link">ES6+</a></li><li><a href="/js/functional.html" class="sidebar-link">함수형 자바스크립트</a></li><li><a href="/js/host-object.html" class="sidebar-link">호스트 객체</a></li><li><a href="/js/inherit.html" class="sidebar-link">inherit</a></li><li><a href="/js/module.html" class="sidebar-link">js module</a></li><li><a href="/js/number.html" class="sidebar-link">Number</a></li><li><a href="/js/object-literal.html" class="sidebar-link">객체 생성</a></li><li><a href="/js/optimizing.html" class="sidebar-link">최적화</a></li><li><a href="/js/phaser3.html" aria-current="page" class="active sidebar-link">Phaser3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/phaser3.html#arcade-physics" class="sidebar-link">Arcade Physics</a></li><li class="sidebar-sub-header"><a href="/js/phaser3.html#ui-scene-분리하기" class="sidebar-link">UI Scene 분리하기</a></li><li class="sidebar-sub-header"><a href="/js/phaser3.html#타이머-예제" class="sidebar-link">타이머 예제</a></li><li class="sidebar-sub-header"><a href="/js/phaser3.html#dom을-이용한-ui그리기" class="sidebar-link">DOM을 이용한 UI그리기</a></li><li class="sidebar-sub-header"><a href="/js/phaser3.html#html-body-등의-태그도-굳이-필요없다-실제-필요한-코드조각만-추가하자" class="sidebar-link">html, body 등의 태그도 굳이 필요없다. 실제 필요한 코드조각만 추가하자.</a></li><li class="sidebar-sub-header"><a href="/js/phaser3.html#tiled-map-editor" class="sidebar-link">tiled map editor</a></li><li class="sidebar-sub-header"><a href="/js/phaser3.html#phaser에서-tiled-map-editor-사용하기" class="sidebar-link">Phaser에서 tiled map editor 사용하기</a></li></ul></li><li><a href="/js/promise.html" class="sidebar-link">Promise API</a></li><li><a href="/js/prototype.html" class="sidebar-link">프로토타입 (prototype)</a></li><li><a href="/js/scope.html" class="sidebar-link">스코프</a></li><li><a href="/js/standard-built-in-object.html" class="sidebar-link">표준 내장 객체</a></li><li><a href="/js/sync-async.html" class="sidebar-link">sync-async</a></li><li><a href="/js/this.html" class="sidebar-link">this</a></li><li><a href="/js/type.html" class="sidebar-link">type</a></li><li><a href="/js/typescript.html" class="sidebar-link">Typescript 기본기와 꿀팁</a></li><li><a href="/js/v8-engine.html" class="sidebar-link">V8 &amp; JITC</a></li><li><a href="/js/var-let-const.html" class="sidebar-link">var, let, const</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/fe" class="sidebar-heading clickable"><span>Front-End</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/browser" class="sidebar-heading clickable"><span>Web Browser</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/server-side" class="sidebar-heading clickable"><span>Server Side</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/cs" class="sidebar-heading clickable"><span>Computer Science</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/git" class="sidebar-heading clickable"><span>Git</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/design-pattern" class="sidebar-heading clickable"><span>Design Pattern</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/nodejs" class="sidebar-heading clickable"><span>Node.js</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/godot" class="sidebar-heading clickable"><span>godot (고도 게임엔진)</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/tip" class="sidebar-heading clickable"><span>개발 관련 Tip</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="phaser3"><a href="#phaser3" class="header-anchor">#</a> Phaser3</h1> <p>Phaser3 js 게임엔진에 대한 포스트입니다.</p> <h1 id="물리엔진"><a href="#물리엔진" class="header-anchor">#</a> 물리엔진</h1> <h2 id="arcade-physics"><a href="#arcade-physics" class="header-anchor">#</a> Arcade Physics</h2> <p>Arcade Physics는 Phaser에서 기본적으로 제공하는 물리엔진이다. Arcade Physics는 물리엔진이라고 하기에는 너무 단순하고, 무거운 물체들의 충돌을 계산하는데는 적합하지 않다. 하지만, 빠르고 간단하게 충돌을 계산할 수 있기 때문에, 게임의 대부분의 요소들에 적합하다.</p> <p><code>Physics.body.setImmovable()</code> 메서드를 사용하면, 물리엔진이 해당 물체를 움직이지 않도록 할 수 있다.</p> <p>immovable이 설정된 객체들끼리의 collider를 설정하면 서로 충돌이 발생하지 않는다.</p> <hr> <h1 id="ui-만들기"><a href="#ui-만들기" class="header-anchor">#</a> UI 만들기</h1> <p>Phaser3에서 UI를 쉽게 만들고 관리하는 방법에 대해 정리하려고 한다.</p> <h2 id="ui-scene-분리하기"><a href="#ui-scene-분리하기" class="header-anchor">#</a> UI Scene 분리하기</h2> <p>UI만을 위한 Scene을 만들어서 관리하는 것이 좋다.</p> <p>단순히 Scene을 하나 추가하고 scene을 launch하는 것으로 UI Scene을 분리할 수 있다.</p> <p>UI만의 Scene을 갖게되면 코드를 분리할 수 있고, UI를 show, hidden처리, camera zoom에 영향을 안받게 하는 처리등 제어가 쉬워진다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// in InGameScene create method</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span><span class="token string">'InGameUIScene'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="타이머-예제"><a href="#타이머-예제" class="header-anchor">#</a> 타이머 예제</h2> <p>뷰포트 상단에 타이머를 표시하고, 타이머가 끝나면 callback을 호출하는 예제이다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// InGameUIScene.ts</span>
<span class="token function">createTimer</span><span class="token punctuation">(</span>min<span class="token operator">:</span> number<span class="token punctuation">,</span> <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> remainingTime <span class="token operator">=</span> min <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> inGameScene <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'InGameScene'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> InGameScene<span class="token punctuation">;</span>

  <span class="token keyword">const</span> remainingTimeText <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>add
    <span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cameras<span class="token punctuation">.</span>main<span class="token punctuation">.</span>centerX<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token function">convertSecondsToMinSec</span><span class="token punctuation">(</span>remainingTime<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token string">'20px'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">'#ffffff'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token string">'#000000'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">strokeThickness</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setOrigin</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setScrollFactor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>time<span class="token punctuation">.</span><span class="token function">addEvent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">delay</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>inGameScene<span class="token punctuation">.</span>player<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">isDestroyed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      remainingTime<span class="token operator">--</span><span class="token punctuation">;</span>
      remainingTimeText<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token function">convertSecondsToMinSec</span><span class="token punctuation">(</span>remainingTime<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>remainingTime <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        remainingTimeText<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        timer<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">loop</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// InGameScene.ts</span>
<span class="token keyword">const</span> inGameUIScene <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'InGameUIScene'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> InGameUIScene<span class="token punctuation">;</span>
inGameUIScene<span class="token punctuation">.</span><span class="token function">createTimer</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something when timer is over</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="dom을-이용한-ui그리기"><a href="#dom을-이용한-ui그리기" class="header-anchor">#</a> DOM을 이용한 UI그리기</h2> <p>html의 button이나 input처럼 interaction이 필요하다면 DOM을 이용한 방법이 좋고, interaction이 필요하지 않다면 Phaser의 Graphics를 이용한 방법이 좋다.</p> <p>DOM을 이용한 방법은 Phaser의 Scene에 DOM을 추가하는 방법이다.</p> <p>DOM을 추가하는 방법은 다음과 같다.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token function">dom</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>DOM을 추가하면 Phaser의 Scene에 DOM이 추가되고, Phaser의 Scene에 추가된 DOM은 Phaser의 Scene에 추가된 Sprite처럼 Phaser의 Scene에 추가된다.</p> <p>프론트 개발자라면 DOM을 이용한 방법이 더 친숙할것이다. API가 매우 유사하기 때문이다.</p> <p>HTML element는 실제 html로 작성하고, phaser에서 불러오면 된다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>load<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">'upgrade'</span><span class="token punctuation">,</span> <span class="token string">'phaser/upgrade.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Phaser<span class="token punctuation">.</span>GameObjects<span class="token punctuation">.</span>DOMElement</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createFromCache</span><span class="token punctuation">(</span><span class="token string">'player_state'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="html-body-등의-태그도-굳이-필요없다-실제-필요한-코드조각만-추가하자"><a href="#html-body-등의-태그도-굳이-필요없다-실제-필요한-코드조각만-추가하자" class="header-anchor">#</a> html, body 등의 태그도 굳이 필요없다. 실제 필요한 코드조각만 추가하자.</h2> <h1 id="바닥-만들기"><a href="#바닥-만들기" class="header-anchor">#</a> 바닥 만들기</h1> <p>어떤 아케이드 게임을 만든다고 가정했을때, 적들이 부딪혀도 피해를 받지않는 바닥이 필요할때 유용할거같은 코드다.</p> <p>tiled에서 오브젝트 레이어를 생성하고 그 좌표에 rect를 생성한다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> safeAreaPoints <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">filterObjects</span><span class="token punctuation">(</span><span class="token string">&quot;SafeArea&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> name<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;SafeArea&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>맵에서 필터링된 오브젝트들(여러개라면)의 좌표를 가져온다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>safeAreas <span class="token operator">=</span> safeAreaPoints<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> safeArea <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token function">rectangle</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// safeArea.setFillStyle(0x00ff00, 0.5);</span>

  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Phaser<span class="token punctuation">.</span>Geom<span class="token punctuation">.</span>Rectangle</span><span class="token punctuation">(</span>
    safeArea<span class="token punctuation">.</span>x<span class="token punctuation">,</span>
    safeArea<span class="token punctuation">.</span>y<span class="token punctuation">,</span>
    safeArea<span class="token punctuation">.</span>width<span class="token punctuation">,</span>
    safeArea<span class="token punctuation">.</span>height
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>좌표를 가져와서 <code>Phaser.Geom.Rectangle</code> 객체를 생성한다.</p> <p>눈으로 확인하고싶다면 <code>setFillStyle</code> 메서드를 사용해서 색을 채워보자.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> isSafe <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>safeAreas<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">safeArea</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Phaser<span class="token punctuation">.</span>Geom<span class="token punctuation">.</span>Rectangle<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>
    safeArea<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>player<span class="token punctuation">.</span>x<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>player<span class="token punctuation">.</span>y
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>Contains</code> 메서드를 사용해서 플레이어의 좌표가 safeArea에 포함되어있는지 확인한다.</p> <p>이런 방법으로 활용해보면 좋다.</p> <hr> <h1 id="tiled"><a href="#tiled" class="header-anchor">#</a> tiled</h1> <p>tiled map editor를 사용하여 맵을 만들고, Phaser에서 사용하는 방법을 알아보자.</p> <h2 id="tiled-map-editor"><a href="#tiled-map-editor" class="header-anchor">#</a> tiled map editor</h2> <p>tiled map editor는 맵을 만들어주는 툴이다. <a href="https://www.mapeditor.org/" target="_blank" rel="noopener noreferrer">tiled map editor<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>에서 다운로드 받을 수 있다.</p> <h2 id="phaser에서-tiled-map-editor-사용하기"><a href="#phaser에서-tiled-map-editor-사용하기" class="header-anchor">#</a> Phaser에서 tiled map editor 사용하기</h2> <h3 id="맵-만들기"><a href="#맵-만들기" class="header-anchor">#</a> 맵 만들기</h3> <p>tiled map editor를 실행하고, 새로운 맵을 선택한다. encoding은 base64(uncompression)로 설정</p> <p>맵을 완성하고나면 별도로 export 할 필요는 없고 json타입으로 저장해두면 된다.</p> <h3 id="phaser에서-맵-사용하기"><a href="#phaser에서-맵-사용하기" class="header-anchor">#</a> Phaser에서 맵 사용하기</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">preload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>load<span class="token punctuation">.</span><span class="token function">tilemapTiledJSON</span><span class="token punctuation">(</span><span class="token string">&quot;map4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;assets/tiled/3.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>load<span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span><span class="token string">&quot;Terrian&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;assets/tiled/Tile1.0.1/Terrian.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>load<span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span><span class="token string">&quot;vegetation&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;assets/tiled/Tile1.0.1/vegetation.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>load<span class="token punctuation">.</span><span class="token function">spritesheet</span><span class="token punctuation">(</span><span class="token string">&quot;player&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;assets/Char2/Char2_idle_16px.png&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">frameWidth</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
    <span class="token literal-property property">frameHeight</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>load<span class="token punctuation">.</span><span class="token function">spritesheet</span><span class="token punctuation">(</span><span class="token string">&quot;exit&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;assets/tiled/Tile1.0.1/Dungeon.png&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">frameWidth</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
    <span class="token literal-property property">frameHeight</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
    <span class="token literal-property property">startFrame</span><span class="token operator">:</span> <span class="token number">86</span><span class="token punctuation">,</span>
    <span class="token literal-property property">endFrame</span><span class="token operator">:</span> <span class="token number">86</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>load<span class="token punctuation">.</span><span class="token function">spritesheet</span><span class="token punctuation">(</span><span class="token string">&quot;pixel_animals&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;assets/pixel_animals.png&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">frameWidth</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
    <span class="token literal-property property">frameHeight</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>make<span class="token punctuation">.</span><span class="token function">tilemap</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&quot;map4&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> vegetationTiles <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">addTilesetImage</span><span class="token punctuation">(</span><span class="token string">&quot;vegetation&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vegetation&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> terrianTiles <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">addTilesetImage</span><span class="token punctuation">(</span><span class="token string">&quot;Terrian&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Terrian&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  map<span class="token punctuation">.</span><span class="token function">createLayer</span><span class="token punctuation">(</span><span class="token string">&quot;bg&quot;</span><span class="token punctuation">,</span> terrianTiles<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> collision_layer <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">createLayer</span><span class="token punctuation">(</span><span class="token string">&quot;bg_collision&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    terrianTiles<span class="token punctuation">,</span>
    vegetationTiles<span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  collision_layer<span class="token punctuation">.</span><span class="token function">setCollisionByExclusion</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> playerSpawnPoint <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">findObject</span><span class="token punctuation">(</span><span class="token string">&quot;PlayerSpawn&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name <span class="token operator">===</span> <span class="token string">&quot;PlayerSpawn1&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> exitPoint <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">findObject</span><span class="token punctuation">(</span><span class="token string">&quot;Exit&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name <span class="token operator">===</span> <span class="token string">&quot;Exit&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> duckSpawnPoints <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">filterObjects</span><span class="token punctuation">(</span><span class="token string">&quot;Duck&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;Duck&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>json파일을 로드한다고해서 tiled 에디터에서 사용했던 이미지 바이너리가 json에 포함될리가 없으므로 같이 로드해줘야한다.</p> <p>특이점으로는 <code>this.make.tilemap</code> 에서 key는 씬에 관계없이 고유한 값이어야한다.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/js/optimizing.html" class="prev">최적화</a></span> <span class="next"><a href="/js/promise.html">Promise API</a>
      →
    </span></p></div>  <div id="comment-wrap"><script src="https://utteranc.es/client.js" repo="jewelism/jewelism.github.io" issue-term="Phaser3" theme="github-light" crossorigin="anonymous" async="async"></script></div></main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.d8edd250.js" defer></script><script src="/assets/js/2.b813d316.js" defer></script><script src="/assets/js/1.63ec6906.js" defer></script><script src="/assets/js/115.49ad11c7.js" defer></script>
  </body>
</html>
