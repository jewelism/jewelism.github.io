<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React | Jewelry Blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-NG6SBMZL');</script>
    <link rel="icon" href="/images/logo.png">
    <meta name="description" content="dev blog">
    <meta property="og:title" content="Jewelry Blog">
    <meta property="og:description" content="dev blog">
    <meta name="naver-site-verification" property="naver-site-verification" content="5b2f37c7b4199869388745a2b48d71230f79701b">
    
    <link rel="preload" href="/assets/css/0.styles.7b19a011.css" as="style"><link rel="preload" href="/assets/js/app.d8edd250.js" as="script"><link rel="preload" href="/assets/js/2.b813d316.js" as="script"><link rel="preload" href="/assets/js/1.63ec6906.js" as="script"><link rel="preload" href="/assets/js/73.58f68dab.js" as="script"><link rel="prefetch" href="/assets/js/10.68915e8a.js"><link rel="prefetch" href="/assets/js/100.d48fb8d1.js"><link rel="prefetch" href="/assets/js/101.b5ebbd9c.js"><link rel="prefetch" href="/assets/js/102.982f90cb.js"><link rel="prefetch" href="/assets/js/103.c96dc806.js"><link rel="prefetch" href="/assets/js/104.f1a3e6c7.js"><link rel="prefetch" href="/assets/js/105.bee66f51.js"><link rel="prefetch" href="/assets/js/106.d4e221ac.js"><link rel="prefetch" href="/assets/js/107.17fa7b87.js"><link rel="prefetch" href="/assets/js/108.036293f3.js"><link rel="prefetch" href="/assets/js/109.f902e0bc.js"><link rel="prefetch" href="/assets/js/11.90e8c648.js"><link rel="prefetch" href="/assets/js/110.23cf18f3.js"><link rel="prefetch" href="/assets/js/111.25a08651.js"><link rel="prefetch" href="/assets/js/112.b575ba09.js"><link rel="prefetch" href="/assets/js/113.39d46774.js"><link rel="prefetch" href="/assets/js/114.54b1d77d.js"><link rel="prefetch" href="/assets/js/115.49ad11c7.js"><link rel="prefetch" href="/assets/js/116.d1eb4002.js"><link rel="prefetch" href="/assets/js/117.641cbc64.js"><link rel="prefetch" href="/assets/js/118.8c20b0ee.js"><link rel="prefetch" href="/assets/js/119.5e1499c4.js"><link rel="prefetch" href="/assets/js/12.566e820c.js"><link rel="prefetch" href="/assets/js/120.bd6dbcbf.js"><link rel="prefetch" href="/assets/js/121.fdb8d482.js"><link rel="prefetch" href="/assets/js/122.2b358183.js"><link rel="prefetch" href="/assets/js/123.47da7d6f.js"><link rel="prefetch" href="/assets/js/124.25f4b64b.js"><link rel="prefetch" href="/assets/js/125.3600f35d.js"><link rel="prefetch" href="/assets/js/126.bf9c3ab6.js"><link rel="prefetch" href="/assets/js/127.2a668d3c.js"><link rel="prefetch" href="/assets/js/128.f6e7d7a4.js"><link rel="prefetch" href="/assets/js/129.de543284.js"><link rel="prefetch" href="/assets/js/13.7d78815a.js"><link rel="prefetch" href="/assets/js/130.b8eb138d.js"><link rel="prefetch" href="/assets/js/131.df799559.js"><link rel="prefetch" href="/assets/js/132.87f8fdd2.js"><link rel="prefetch" href="/assets/js/133.1ecedbc9.js"><link rel="prefetch" href="/assets/js/134.050b3131.js"><link rel="prefetch" href="/assets/js/135.67fab777.js"><link rel="prefetch" href="/assets/js/136.5606edf6.js"><link rel="prefetch" href="/assets/js/137.e66661fb.js"><link rel="prefetch" href="/assets/js/138.f9436bbb.js"><link rel="prefetch" href="/assets/js/139.8ea1d596.js"><link rel="prefetch" href="/assets/js/14.a384c04f.js"><link rel="prefetch" href="/assets/js/140.ac02ebc5.js"><link rel="prefetch" href="/assets/js/141.14b29649.js"><link rel="prefetch" href="/assets/js/142.e57ed7db.js"><link rel="prefetch" href="/assets/js/143.06f2348c.js"><link rel="prefetch" href="/assets/js/144.a54de9c0.js"><link rel="prefetch" href="/assets/js/145.8714c371.js"><link rel="prefetch" href="/assets/js/146.afd802e8.js"><link rel="prefetch" href="/assets/js/15.5581965d.js"><link rel="prefetch" href="/assets/js/16.36a6df8c.js"><link rel="prefetch" href="/assets/js/17.58419ce3.js"><link rel="prefetch" href="/assets/js/18.78334840.js"><link rel="prefetch" href="/assets/js/19.31ca3599.js"><link rel="prefetch" href="/assets/js/20.55945dbc.js"><link rel="prefetch" href="/assets/js/21.6ddb8d2b.js"><link rel="prefetch" href="/assets/js/22.8d390135.js"><link rel="prefetch" href="/assets/js/23.5d48bf66.js"><link rel="prefetch" href="/assets/js/24.98a3f2a7.js"><link rel="prefetch" href="/assets/js/25.58157085.js"><link rel="prefetch" href="/assets/js/26.f12be7ca.js"><link rel="prefetch" href="/assets/js/27.8b47009c.js"><link rel="prefetch" href="/assets/js/28.94f9feb0.js"><link rel="prefetch" href="/assets/js/29.5b7d2648.js"><link rel="prefetch" href="/assets/js/3.333fb557.js"><link rel="prefetch" href="/assets/js/30.705c0baa.js"><link rel="prefetch" href="/assets/js/31.fdb59e0f.js"><link rel="prefetch" href="/assets/js/32.2383a55b.js"><link rel="prefetch" href="/assets/js/33.bfbec105.js"><link rel="prefetch" href="/assets/js/34.69f76c89.js"><link rel="prefetch" href="/assets/js/35.9f0aa7e6.js"><link rel="prefetch" href="/assets/js/36.02beee59.js"><link rel="prefetch" href="/assets/js/37.19802134.js"><link rel="prefetch" href="/assets/js/38.5653c840.js"><link rel="prefetch" href="/assets/js/39.e3b746fa.js"><link rel="prefetch" href="/assets/js/4.95c43ca0.js"><link rel="prefetch" href="/assets/js/40.96d79a78.js"><link rel="prefetch" href="/assets/js/41.268c3897.js"><link rel="prefetch" href="/assets/js/42.2339675a.js"><link rel="prefetch" href="/assets/js/43.826b5267.js"><link rel="prefetch" href="/assets/js/44.7eabcb79.js"><link rel="prefetch" href="/assets/js/45.e9a3bb83.js"><link rel="prefetch" href="/assets/js/46.7a822972.js"><link rel="prefetch" href="/assets/js/47.5e9b258d.js"><link rel="prefetch" href="/assets/js/48.6db42384.js"><link rel="prefetch" href="/assets/js/49.99deed78.js"><link rel="prefetch" href="/assets/js/5.9d9e1e88.js"><link rel="prefetch" href="/assets/js/50.7829d7c4.js"><link rel="prefetch" href="/assets/js/51.9941a5c2.js"><link rel="prefetch" href="/assets/js/52.c528219a.js"><link rel="prefetch" href="/assets/js/53.b486f5b8.js"><link rel="prefetch" href="/assets/js/54.3590e606.js"><link rel="prefetch" href="/assets/js/55.3f5aa439.js"><link rel="prefetch" href="/assets/js/56.d22c590b.js"><link rel="prefetch" href="/assets/js/57.af5f42f5.js"><link rel="prefetch" href="/assets/js/58.b12ffd2f.js"><link rel="prefetch" href="/assets/js/59.32c30e64.js"><link rel="prefetch" href="/assets/js/60.e8005a21.js"><link rel="prefetch" href="/assets/js/61.322cf604.js"><link rel="prefetch" href="/assets/js/62.c11f3a96.js"><link rel="prefetch" href="/assets/js/63.c5506d7b.js"><link rel="prefetch" href="/assets/js/64.0d80102d.js"><link rel="prefetch" href="/assets/js/65.dfb2d864.js"><link rel="prefetch" href="/assets/js/66.370ef41d.js"><link rel="prefetch" href="/assets/js/67.88c9e001.js"><link rel="prefetch" href="/assets/js/68.f338a0d2.js"><link rel="prefetch" href="/assets/js/69.bdb4c5b0.js"><link rel="prefetch" href="/assets/js/70.c38e5f80.js"><link rel="prefetch" href="/assets/js/71.88270db3.js"><link rel="prefetch" href="/assets/js/72.dcd32982.js"><link rel="prefetch" href="/assets/js/74.4ada683a.js"><link rel="prefetch" href="/assets/js/75.a6d32488.js"><link rel="prefetch" href="/assets/js/76.c0d0c351.js"><link rel="prefetch" href="/assets/js/77.5c46677d.js"><link rel="prefetch" href="/assets/js/78.d2e954df.js"><link rel="prefetch" href="/assets/js/79.737ec5f0.js"><link rel="prefetch" href="/assets/js/8.ca781c48.js"><link rel="prefetch" href="/assets/js/80.5d71fe19.js"><link rel="prefetch" href="/assets/js/81.217ef913.js"><link rel="prefetch" href="/assets/js/82.7362843c.js"><link rel="prefetch" href="/assets/js/83.5e90d306.js"><link rel="prefetch" href="/assets/js/84.4420de65.js"><link rel="prefetch" href="/assets/js/85.473092ef.js"><link rel="prefetch" href="/assets/js/86.04701726.js"><link rel="prefetch" href="/assets/js/87.83273b43.js"><link rel="prefetch" href="/assets/js/88.676b6f5c.js"><link rel="prefetch" href="/assets/js/89.9ba0b94d.js"><link rel="prefetch" href="/assets/js/9.13b3374f.js"><link rel="prefetch" href="/assets/js/90.eb51ebaa.js"><link rel="prefetch" href="/assets/js/91.7b0c3d93.js"><link rel="prefetch" href="/assets/js/92.af3e1247.js"><link rel="prefetch" href="/assets/js/93.776e9706.js"><link rel="prefetch" href="/assets/js/94.43b48ebf.js"><link rel="prefetch" href="/assets/js/95.ba8e4bc1.js"><link rel="prefetch" href="/assets/js/96.2fa5d3a3.js"><link rel="prefetch" href="/assets/js/97.1c4f3144.js"><link rel="prefetch" href="/assets/js/98.0c7cbaa6.js"><link rel="prefetch" href="/assets/js/99.b171f0e5.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.73bb25e3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7b19a011.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name" style="margin-left:15px;">Jewelry Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/js" class="sidebar-heading clickable"><span>Javascript</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/fe" class="sidebar-heading clickable router-link-active open"><span>Front-End</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/fe/charles-proxy.html" class="sidebar-link">찰스 프록시 사용하기</a></li><li><a href="/fe/component.html" class="sidebar-link">컴포넌트와 컴포넌트 설계</a></li><li><a href="/fe/cors.html" class="sidebar-link">cors</a></li><li><a href="/fe/csr-ssr.html" class="sidebar-link">CSR, SSR</a></li><li><a href="/fe/css.html" class="sidebar-link">CSS</a></li><li><a href="/fe/jest-snapshot-test.html" class="sidebar-link">Snapshot Test</a></li><li><a href="/fe/optimizing.html" class="sidebar-link">최적화 관련</a></li><li><a href="/fe/pre-render.html" class="sidebar-link">Pre-render</a></li><li><a href="/fe/proxy.html" class="sidebar-link">proxy</a></li><li><a href="/fe/react-auto-batch.html" class="sidebar-link">React Auto Batching</a></li><li><a href="/fe/react-hook-test-jest.html" class="sidebar-link">React Hook Test with Jest</a></li><li><a href="/fe/react-native.html" class="sidebar-link">React-native</a></li><li><a href="/fe/react-tutorial.html" class="sidebar-link">React Tutorial</a></li><li><a href="/fe/react.html" aria-current="page" class="active sidebar-link">React</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fe/react.html#hook-api" class="sidebar-link">Hook API</a></li><li class="sidebar-sub-header"><a href="/fe/react.html#사용-규칙" class="sidebar-link">사용 규칙</a></li><li class="sidebar-sub-header"><a href="/fe/react.html#근데-왜-이걸-사용하나" class="sidebar-link">근데 왜 이걸 사용하나?</a></li><li class="sidebar-sub-header"><a href="/fe/react.html#usestate" class="sidebar-link">useState</a></li><li class="sidebar-sub-header"><a href="/fe/react.html#useeffect" class="sidebar-link">useEffect</a></li><li class="sidebar-sub-header"><a href="/fe/react.html#usememo-usecallback" class="sidebar-link">useMemo, useCallback</a></li><li class="sidebar-sub-header"><a href="/fe/react.html#dependency-list-deps" class="sidebar-link">dependency list (deps)</a></li><li class="sidebar-sub-header"><a href="/fe/react.html#custom-hook" class="sidebar-link">custom hook</a></li><li class="sidebar-sub-header"><a href="/fe/react.html#with-string" class="sidebar-link">with string</a></li><li class="sidebar-sub-header"><a href="/fe/react.html#_1-클래스-컴포넌트인-경우" class="sidebar-link">1. 클래스 컴포넌트인 경우</a></li><li class="sidebar-sub-header"><a href="/fe/react.html#_2-함수형-컴포넌트인-경우" class="sidebar-link">2. 함수형 컴포넌트인 경우</a></li></ul></li><li><a href="/fe/rxjs.html" class="sidebar-link">RxJS</a></li><li><a href="/fe/scrolltobottom.html" class="sidebar-link">scrollToBottom</a></li><li><a href="/fe/seo-check-point.html" class="sidebar-link">SEO Check Point</a></li><li><a href="/fe/testing-in-mobile.html" class="sidebar-link">모바일 브라우저 테스트 환경설정</a></li><li><a href="/fe/virtual-dom.html" class="sidebar-link">Virtual DOM, Key</a></li><li><a href="/fe/vue-tutorial.html" class="sidebar-link">Vue Tutorial</a></li><li><a href="/fe/watch.html" class="sidebar-link">watch 구현</a></li><li><a href="/fe/web-term.html" class="sidebar-link">웹 관련 용어</a></li><li><a href="/fe/webpack-babel.html" class="sidebar-link">webpack, babel</a></li><li><a href="/fe/webpack-dev-server.html" class="sidebar-link">webpack-dev-server</a></li><li><a href="/fe/webview.html" class="sidebar-link">webview</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/browser" class="sidebar-heading clickable"><span>Web Browser</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/server-side" class="sidebar-heading clickable"><span>Server Side</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/cs" class="sidebar-heading clickable"><span>Computer Science</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/git" class="sidebar-heading clickable"><span>Git</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/design-pattern" class="sidebar-heading clickable"><span>Design Pattern</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/nodejs" class="sidebar-heading clickable"><span>Node.js</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/godot" class="sidebar-heading clickable"><span>godot (고도 게임엔진)</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/tip" class="sidebar-heading clickable"><span>개발 관련 Tip</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react"><a href="#react" class="header-anchor">#</a> React</h1> <ul><li>facebook에서 만들고 활용하고 있는 ui 라이브러리</li></ul> <p>핵심 개념인 컴포넌트는 <a href="/fe/component.html">여기에서 설명</a>합니다.</p> <p>리액트는 ReactDOM 이라는 별도의 패키지의 render 메소드를 사용하여</p> <p>React 컴포넌트를(VDOM) 실제로 DOM에 렌더링할 수 있습니다.</p> <h2 id="hook-api"><a href="#hook-api" class="header-anchor">#</a> Hook API</h2> <p>hook 혹은 hooking 이라는 용어는.. 프로세스를 가로채고 정상적인 프로세스를 방해 할 수 있다는 의미입니다.</p> <p>react hook에서는 (과거 stateless로 사용했던) functional component에서도 상태를 가질 수 있으며</p> <p>라이프사이클을 대체할 수 있는 함수를 제공합니다. (useEffect)</p> <p>이제는 react개발의 핵심이 된 react 라이브러리의 최신 API입니다.</p> <h2 id="사용-규칙"><a href="#사용-규칙" class="header-anchor">#</a> 사용 규칙</h2> <ol><li>컴포넌트에서 훅을 호출하는 순서가 보장되어야한다.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>순서가 보장되어야한다는 것은 제어구조 내에서 사용하지 말라는 것입니다.

리액트 내부에서 관리하는, 훅을 위한 인덱싱이 깨질 수 있기 때문이죠.
</code></pre></div><ol start="2"><li><p>훅은 함수형 컴포넌트 혹은 커스텀 훅 안에서만 호출한다.</p></li> <li><p>use~ 로 네이밍한다. 에러는 아니지만 경고가 뜬다.</p></li></ol> <h2 id="근데-왜-이걸-사용하나"><a href="#근데-왜-이걸-사용하나" class="header-anchor">#</a> 근데 왜 이걸 사용하나?</h2> <p>사실 가장 큰 단점은 props가 암묵적으로 넘어온다는점 입니다. hoc를 많이 사용하면 props 이름 충돌의 가능성도 배제할 순 없죠.</p> <p>함수형 컴포넌트에서 state를 사용하기위해 사용하는것도 맞지만,</p> <p>공통 비즈니스로직들을 사용하기위해 hoc를 활용했는데, 복잡해질수록 Wrapper가 늘어나기만하고..</p> <p>hoc를 여러개 중첩하면 보기도 힘들고, 어떤 hoc가 어떤 로직을 가졌는지 파악하기도 쉽지않고,</p> <p>여러개의 life cycle에 중복 로직도 들어가고, 로직들이 흩어지기도 하고.. 점점 복잡해지고 헷갈리며 테스트하기도 어려워집니다.</p> <p>vue의 경우에는 hoc와 비슷하면서도 다른 mixins를 이용해서 중복 로직을 처리하는데,</p> <p>같은 문제가 있어서 vue3에서 react hook에 영감을 받아 개발한 composition API를 공개했죠.</p> <p>아래에서는 가장 많이 사용하는 hook API 3개와 커스텀 hook을 소개합니다.</p> <hr> <h2 id="usestate"><a href="#usestate" class="header-anchor">#</a> useState</h2> <p>useState 훅은 기존 클래스형 컴포넌트의 state와 setState를 대체합니다.</p> <p>useState 함수는 파라미터로 state초기값을 넘겨주고, 아래와 같이 배열을 리턴합니다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>배열의 두번째에 위치한 setState함수로 state를 변경 할 수 있습니다.</p> <p>또한 setter에 함수를 사용할 수도 있습니다.</p> <p>아래 코드는 단순 boolean을 toggle하는 함수를 활용하는 예시입니다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//typescript</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>flag<span class="token punctuation">,</span> setFlag<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">toggleFlag1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">toggleFlag2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prevState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>prevState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>장점이 전혀 없는것처럼 보일 수도 있지만..</p> <p>useCallback으로 toggleFlag를 다시 작성하면..</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//typescript</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>flag<span class="token punctuation">,</span> setFlag<span class="token punctuation">]</span> <span class="token operator">=</span> useState<span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> toggleFlag1 <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>flag<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> toggleFlag2 <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setFlag</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prevState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>prevState<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>deps에서 차이를 보이고 있습니다.</p> <p>가능하면 deps가 적을수록 좋습니다. deps중에 하나라도 변경되면, 해당 훅이 다시 실행됩니다.</p> <p>함수를 자주 새로 생성하는것을 줄이는건 성능에 거의 영향을 주지않지만 나름 의미도 있고,</p> <p>훅이 특정 상태에 의존성을 갖게 되는것이 중요하다고 할 수 있습니다.</p> <h2 id="useeffect"><a href="#useeffect" class="header-anchor">#</a> useEffect</h2> <p>기존 클래스 컴포넌트로는 생명주기 메소드를 이용했는데, 이제는 생명주기가 아닌 '상태'주기를 이용해야합니다.</p> <p>리액트 생명주기 메소드는 호출 타이밍이 정해져있죠. 고정된 파이프라인입니다.</p> <p>반면에 useEffect로 생성하는 상태주기 메소드는 프로그래밍 가능한 수많은 파이프라인입니다.</p> <p>이제 API호출해야하는 타이밍에 대해 의견이 엇갈 일 조차도 없습니다.</p> <p>상태주기를 다루고 있으므로, 각 훅의 deps에 의존성을 모두 추가하는것이 정상이며, 그렇게 해야합니다. eslint에 좋은 플러그인이 존재합니다.</p> <p>useEffect를 여러번 사용해서, 기능별로 분리해놓으면 원하는 기능을 버그없이 구현할 수 있습니다.</p> <p>아래는 간단한 예제입니다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//...some effect code</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...some clean up code</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token comment">//deps</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>아래 코드처럼 props가 변경될때 state를 변경시키도록 할 수도 있습니다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">SomeComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>myInput<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>input<span class="token punctuation">,</span> setInput<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setInput</span><span class="token punctuation">(</span>myInput<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>myInput<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// setInput????</span>
<span class="token punctuation">}</span>
</code></pre></div><p>setInput은 왜 deps에 포함시키지않아도 될까요?</p> <p>effect는 deps 중에 하나라도 변경되면 trigger되는데요, setInput은 어차피 변하지않기때문입니다..!</p> <p>그러므로 변하지않는값은 넣지않아도 됩니다.</p> <p>아래에 헷갈릴 수도 있는 예제를 하나 추가합니다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">SomeComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> isNotZero <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> b <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">somePureFunction</span><span class="token punctuation">(</span>a <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> b <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">somePureFunction</span><span class="token punctuation">(</span>isNotZero<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>isNotZero<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>두 개의 effect는 로직이 같습니다. 하지만 실행되는 횟수는 달라질 수 있습니다.</p> <p>isNotZero 는 a, b를 deps로 가지는데, 값은 true, false 중에 하나입니다.</p> <p>첫번째 effect는 a 혹은 b가 변경되면 실행될것이고</p> <p>두번째 effect는 isNotZero의 '값'(true, false)가 달라지면 실행될것입니다.</p> <p>isNotZero가 a, b가 달라져서 재계산하더라도, 결국 값이 달라지지 않았다면 effect가 실행되지 않습니다.</p> <h2 id="usememo-usecallback"><a href="#usememo-usecallback" class="header-anchor">#</a> useMemo, useCallback</h2> <p>용도 자체는 레퍼런스 변경을 방지하는 것 입니다.</p> <p>예를 들어, 상위 컴포넌트에서 props로 함수를 하위 컴포넌트에게 전달한다고 가정합니다.</p> <p>이때, 상위 컴포넌트 렌더링이 돌면, props로 넘겼던 함수의 레퍼런스가 변경됩니다.</p> <p>실제로 함수자체가 변경되지않았음에도 함수가 재생성되어 props가 변경됐다고 가정한 하위 컴포넌트는</p> <p>쓸데없이 리렌더될 수 있습니다.</p> <p>useMemo는 값을 메모이제이션 한다는 특징이 있어서 비싼 연산을 기억하여 최적화 할 수도 있습니다.</p> <p>하지만 react 공식문서에서는 추후 업데이트에서 재계산을 할지도 모르니, 성능향상으로 쓰지말라고 가이드합니다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>myName<span class="token punctuation">,</span> setMyName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;boseok jung&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> reversedMyName <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>myName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>myName<span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reversedMyName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// gnuj koesob</span>
</code></pre></div><p>아래는 useMemo와 useCallback을 비교한 것입니다.</p> <p>사실 useCallback은 명시적으로 함수일것이다를 알 수 있는 것 외에는 useMemo와 동일하게 동작합니다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">someFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">&quot;boseok&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> memo <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> someFunction<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>someFunction<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>아래처럼 deps관리를 위해서라도 같은 deps를 가진 컴포넌트 변수(함수 포함)들이 있다면, 하나의 useMemo를 통해 변수들을 반환받는게 좋을것입니다.</p> <p>(곧 나오는 용어인 deps는 아래서 설명하고 있습니다.)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>nameLength<span class="token punctuation">,</span> reversedName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>name<span class="token punctuation">.</span>length<span class="token punctuation">,</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>name<span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// const nameLength = useMemo(() =&gt; name.length, [name]);</span>
<span class="token comment">// const reversedName = useMemo(</span>
<span class="token comment">//   () =&gt; name.length,</span>
<span class="token comment">//   Array.from(name)</span>
<span class="token comment">//     .reverse()</span>
<span class="token comment">//     .join(''),</span>
<span class="token comment">//   [name]</span>
<span class="token comment">// );</span>
</code></pre></div><p>간단한 예제인데, 주석처럼 작성하면... 로직이 길고 복잡하다고 가정했을때 =&gt; 어떤 훅에 name dependency가 있는지 코드를 전부 파악해야하고, 수정하기 두렵습니다.</p> <p>useCallback에 대해 조금 더 이야기 해보자면.. memo로 동일한 기능을 구현할 수 있어서 useCallback이 필요없을지도 모르겠지만</p> <p>useCallback의 존재 이유는 변수인지 함수인지 구분하기 위함도 있고, useEffect와 함께 사용할때</p> <p>useEffet 훅이 deps의 레퍼런스 체크할때의 의미가 있습니다.</p> <p>어차피 렌더하는 횟수만큼 함수자체는 생성하겠지만, 변수에 할당을 안한다는 의미입니다.</p> <p>함수의 생성 자체는 경량함수인 arrow function을 사용할 것이고, 그정도 비용은 무시합니다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SomeComponent</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> onClick <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> someEffect1 <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// something...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">someEffect2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">someEffect1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>someEffect1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">someEffect2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>someEffect2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>name<span class="token operator">:</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>onClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        click<span class="token operator">!</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>우선 someEffect2는 아마 lint를 쓴다면 경고를 띄워줄겁니다.</p> <p>someEffect2를 useCallback을 써라 혹은 deps를 지워라.</p> <p>어차피 매번 someEffect2라는 변수에는 새로운 함수가 할당될것이기때문이죠.</p> <p>반면 someEffect1의 사용은 옳습니다.</p> <p>someEffect1의 레퍼런스는 오직 someEffect1의 deps에 의해 변하므로, 변하지않거든요.</p> <hr> <h2 id="dependency-list-deps"><a href="#dependency-list-deps" class="header-anchor">#</a> dependency list (deps)</h2> <p>useEffect, useMemo, useCallback의 두번째인자는 DependencyList 입니다.</p> <p>배열을 넘겨주면되고, 배열의 요소는 특정 변수들을 넣어주면되는데,</p> <p>useMemo의 경우,</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>myName<span class="token punctuation">,</span> setMyName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;boseok jung&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> reversedMyName <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>myName<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>myName<span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>myName이라는 state에 의존하고있으므로, myName을 넣어줍니다.</p> <p>reversedMyName이라는 변수가 갱신되는 조건이 myName이라는 변수가 변경됐을 때 콜백을 다시 실행하여 갱신하고, 그것을 메모이제이션하는 겁니다.</p> <p>vscode 플러그인 같은걸 사용하면, 자동으로 넣어주기도 합니다.</p> <h2 id="custom-hook"><a href="#custom-hook" class="header-anchor">#</a> custom hook</h2> <p>기존 클래스 컴포넌트에서는 공통 로직을 분리하기위해 with~ 라는 단어로 시작하는 hoc를 만들곤 했는데요,</p> <p>요즘은 클래스 컴포넌트 대신 함수형 컴포넌트와 hook을 사용하기때문에, 공통 로직을 위해서는 hook을 만들어서 사용합니다</p> <p>네이밍 컨벤션은 use~입니다. useState처럼요. 이 컨벤션은 리액트의 프리컴파일러에 의해 강제됩니다. use로 시작하지않으면 아마 에러가 날겁니다.</p> <p>이제 예제를 볼까요?</p> <p>아래와 같은 두 컴포넌트가 있습니다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">Page1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isChecked<span class="token punctuation">,</span> setIsChecked<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">onChangeCheckBox</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setIsChecked</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prevState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>prevState<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>페이지<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;checkbox&quot;</span> checked<span class="token operator">=</span><span class="token punctuation">{</span>isChecked<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>onChangeCheckBox<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>선택<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Page2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isChecked<span class="token punctuation">,</span> setIsChecked<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> <span class="token function-variable function">onChangeCheckBox</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setIsChecked</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prevState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>prevState<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>페이지<span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;checkbox&quot;</span> checked<span class="token operator">=</span><span class="token punctuation">{</span>isChecked<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>onChangeCheckBox<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>선택<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token comment">/* some elements... */</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>엄청 좋은 예제는 아니지만 이해를 돕기엔 충분합니다.</p> <p>custom hook을 사용하여 이런식으로 유사한 로직을 분리할 수 있습니다.</p> <p>추가로 useMemo와 유사한 useCallback의 활용도 볼 수 있습니다~</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">useCheckBox</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">initialState <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isChecked<span class="token punctuation">,</span> setIsChecked<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> onChangeCheckBox <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setIsChecked</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prevState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>prevState<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">[</span>isChecked<span class="token punctuation">,</span> onChangeCheckBox<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useCheckBox<span class="token punctuation">;</span>
</code></pre></div><p>커스텀 훅은 별게없고 함수형 컴포넌트랑 유사하지만 단지 JSX (ReactNode)를 리턴하지 않고 로직에 대한 상태나 setter를 리턴하는 것 뿐입니다.</p> <p>생성한 커스텀 훅을 활용하여 다시 Page1만 작성해보면 아래와 같을 것 입니다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> useCheckBox <span class="token keyword">from</span> <span class="token string">&quot;./useCheckBox&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Page1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isChecked<span class="token punctuation">,</span> onChangeCheckBox<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useCheckBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>페이지<span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;checkbox&quot;</span> checked<span class="token operator">=</span><span class="token punctuation">{</span>isChecked<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>onChangeCheckBox<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>선택<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>예제의 useCheckBox에 해당하는 로직이 짧아서 큰 메리트를 못 느낄수있지만,</p> <p>뷰와 모델을 깔끔하게 분리해내고나면 컴포넌트 자체 가독성이 좋아지고 테스트하기 편해집니다.</p> <hr> <p>changeEvent를 받아서 value를 뽑아내고 validate function을 호출하고..</p> <p>setState해주는 로직을 갖고있는 custom hook 예제입니다 (타입스크립트)</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useCallback<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> IIsValidTextInputOptions<span class="token punctuation">,</span> isValidTextInput <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;utils/validate&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">IUseTextInput</span> <span class="token punctuation">{</span>
  initialValue<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  validatorOption<span class="token operator">?</span><span class="token operator">:</span> IIsValidTextInputOptions<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> <span class="token class-name">ChangeEventType</span> <span class="token operator">=</span> React<span class="token punctuation">.</span>ChangeEvent<span class="token operator">&lt;</span>
  HTMLInputElement <span class="token operator">|</span> HTMLTextAreaElement
<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * [text, onChangeText]
 * validator는 validatorOption의 property가 하나라도 있어야 작동합니다.
 * 그래서 기본적으로 validate는 하지않습니다
 */</span>

<span class="token keyword">const</span> useTextInput <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  initialValue <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  validatorOption <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> IUseTextInput <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> ChangeEventType<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> setText<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> onChangeText <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span>e<span class="token operator">:</span> ChangeEventType<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
      <span class="token keyword">const</span> isUsingValidator <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>validatorOption<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        <span class="token operator">!</span>isUsingValidator <span class="token operator">||</span>
        <span class="token punctuation">(</span>isUsingValidator <span class="token operator">&amp;&amp;</span> <span class="token function">isValidTextInput</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> validatorOption<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setText</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>validatorOption<span class="token punctuation">]</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">[</span>text<span class="token punctuation">,</span> onChangeText<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useTextInput<span class="token punctuation">;</span>
</code></pre></div><hr> <p>API 호출하는부분에서 API 로딩과 에러를 promise 친숙하게 ts로 작성한 hook입니다. 참고만하세요..</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">Method</span> <span class="token operator">=</span> <span class="token string">&quot;GET&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;POST&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;PUT&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;DELETE&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">APIFunctionReturn<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token constant">T</span><span class="token punctuation">,</span> StateUpdater<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span> <span class="token builtin">boolean</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">APIStatus</span> <span class="token operator">=</span> <span class="token string">&quot;PENDING&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;FULFILLED&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;REJECTED&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> useFetch <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token operator">=</span> <span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
  <span class="token function-variable function">apiFunction</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  method<span class="token operator">:</span> Method <span class="token operator">=</span> <span class="token string">&quot;GET&quot;</span>
<span class="token punctuation">)</span><span class="token operator">:</span> APIFunctionReturn<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> setData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>apiStatus<span class="token punctuation">,</span> setApiStatus<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>APIStatus<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;PENDING&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> isLoading <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> apiStatus <span class="token operator">===</span> <span class="token string">&quot;PENDING&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>apiStatus<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> isError <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> apiStatus <span class="token operator">===</span> <span class="token string">&quot;REJECTED&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>apiStatus<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">apiFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">setData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">setApiStatus</span><span class="token punctuation">(</span><span class="token string">&quot;FULFILLED&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">setApiStatus</span><span class="token punctuation">(</span><span class="token string">&quot;REJECTED&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>apiFunction<span class="token punctuation">,</span> method<span class="token punctuation">,</span> data<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">[</span>data<span class="token punctuation">,</span> isLoading<span class="token punctuation">,</span> isError<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useFetch<span class="token punctuation">;</span>
</code></pre></div><h1 id="커스텀-훅으로-ui와-로직의-깔끔한-분리"><a href="#커스텀-훅으로-ui와-로직의-깔끔한-분리" class="header-anchor">#</a> 커스텀 훅으로 ui와 로직의 깔끔한 분리</h1> <p>위에 있는 내용을 이해했다면, 커스텀 훅으로 ui와 로직의 분리가 가능하겠죠?</p> <p>컴포넌트는 props와 하나의 커스텀훅만 가지는게 꽤나 좋은 설계입니다.</p> <p>그 커스텀 훅 내부에서 또 여러개의 훅을 쓸지라도요.</p> <p>이렇게 모델과 ui가 분리되면 해당 컴포넌트 자체는 훅만 테스트하면 됩니다.</p> <p>앱이 안정적이고 유지보수하기 좋게 됩니다.</p> <hr> <h1 id="dynamic-component"><a href="#dynamic-component" class="header-anchor">#</a> Dynamic Component</h1> <h2 id="with-string"><a href="#with-string" class="header-anchor">#</a> with string</h2> <p>string으로 다이나믹 컴포넌트 렌더링하는 방법.</p> <p>vue와 유사한 형태</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Card1 <span class="token keyword">from</span> <span class="token string">'./Card1'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Card2 <span class="token keyword">from</span> <span class="token string">'./Card2'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Card3 <span class="token keyword">from</span> <span class="token string">'./Card3'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> CardComponents <span class="token operator">=</span> <span class="token punctuation">{</span>
  Card1<span class="token punctuation">,</span>
  Card2<span class="token punctuation">,</span>
  Card3<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 이렇게 하거나..</span>
<span class="token keyword">const</span> <span class="token function-variable function">Component</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>is<span class="token punctuation">,</span> components<span class="token punctuation">,</span> <span class="token operator">...</span>props<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> DynamicComponent <span class="token operator">=</span> components<span class="token punctuation">[</span>is<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>DynamicComponent <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 혹은..</span>
<span class="token keyword">const</span> <span class="token function-variable function">Component</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>is<span class="token punctuation">,</span> components<span class="token punctuation">,</span> <span class="token operator">...</span>props<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>components<span class="token punctuation">[</span>is<span class="token punctuation">]</span><span class="token punctuation">,</span> props<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>currentComponent<span class="token punctuation">,</span> setCurrentComponent<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Card1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Component is<span class="token operator">=</span><span class="token punctuation">{</span>currentComponent<span class="token punctuation">}</span> components<span class="token operator">=</span><span class="token punctuation">{</span>CardComponents<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="input-type-file"><a href="#input-type-file" class="header-anchor">#</a> input type file</h1> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>요런 녀석으로 file을 업로드할 수 있다.</p> <p>react에서는 onChange 이벤트를 바인딩해줘야한다.</p> <p>그런데 브라우저 동작이 같은 파일을 연속 두번 업로드하게되면,</p> <p>파일이 바뀐게 아니므로, onChange가 작동을 안한다.</p> <p>그런데 작동하게 해야할 기획이 들어왔다고하면.. 되게 해야한다.</p> <p>file은 수정할 수 없으므로 value를 바인딩할수도 없다.</p> <p>그래서 ref를 이용하여 아래와 같이 바인딩해준다</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>{fileRef}</span> <span class="token special-attr"><span class="token attr-name">onChange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token value javascript language-javascript"><span class="token punctuation">{</span>onChangeImage<span class="token punctuation">}</span></span></span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>이런식으로.. 바인딩해주고,</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fileRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>fileRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
</code></pre></div><p>이런 식으로 value를 적절한 곳에서 초기화시켜버리면 된다.</p> <h1 id="performance"><a href="#performance" class="header-anchor">#</a> Performance</h1> <h2 id="_1-클래스-컴포넌트인-경우"><a href="#_1-클래스-컴포넌트인-경우" class="header-anchor">#</a> 1. 클래스 컴포넌트인 경우</h2> <p>(클래스 컴포넌트를 사용할때만!)</p> <p>react는 react만의 최적화 기법이 있다.</p> <p>lifecycle 메소드를 이용하는 방법이다.</p> <p>우선 react는 state, props가 변경되면 해당 컴포넌트를 다시 렌더링한다.</p> <p>react의 shouldComponentUpdate lifecycle method에는 nextProps, nextState가 순서대로 파라미터에 전달된다.</p> <p>파라미터 이름만봐도 대충 짐작이 간다.</p> <p>현재 state와 props 전달받은 state와 props를 비교할수있다.</p> <p>컴포넌트를 다시 그리고싶다면 true를 리턴하면되고, 최적화를 위해 리렌더링을 하기싫다면- false를 리턴하면된다.</p> <p>더 자세히 알고싶다면 공식문서를..</p> <p><a href="https://reactjs.org/docs/react-component.html#shouldcomponentupdate" target="_blank" rel="noopener noreferrer">https://reactjs.org/docs/react-component.html#shouldcomponentupdate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>state와 props 구조가 단순하고, 구현하기귀찮다면</p> <p>클래스에 Component를 상속받지말고, PureComponent를 상속받으면 된다.</p> <p>PureComponent에는 shouldComponentUpdate 메소드가 이미 구현되어있다.</p> <p>react 개발자 중 한명은 PureComponent를 사용하는것을 권장하지않는다.</p> <p>곧 react가 버전업하게되면, 함수형 컴포넌트의 성능을 향상시킬 것이라고 한다.</p> <p>컴포넌트에 lifecycle이 필요없다면 함수형 컴포넌트를 사용하도록 하는것이 향후에</p> <p>성능을 좋게 하는 방법이라고 할 수 있겠다.</p> <h2 id="_2-함수형-컴포넌트인-경우"><a href="#_2-함수형-컴포넌트인-경우" class="header-anchor">#</a> 2. 함수형 컴포넌트인 경우</h2> <p>react hook을 이용하여 프로퍼티 혹은 변수, 메소드를 캐싱하자.</p> <p>=&gt; 성능이슈가 있는 컴포넌트에서 useMemo, useCallback을 적극적으로 활용하자.</p> <h3 id="useselector를-사용하는-경우"><a href="#useselector를-사용하는-경우" class="header-anchor">#</a> useSelector를 사용하는 경우</h3> <p>구조분해할당을 알고있다면 아래처럼 사용하고 싶을것이다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// state.user = {name, email, phone} &lt;= 이렇다고 가정하자.</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span>name<span class="token punctuation">,</span> email<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>하지만 이 방법은 해당 훅에서 state.user를 바라보고있기때문에, 레퍼런스가 변경되면 다시 렌더한다.</p> <p>다시 말하면 name, email이 변경되지않고 phone이 변경되어도 리렌더한다.</p> <p>이런 경우에는 디스트럭쳐링을 활용할 수 없고, 풀어서 쓰거나..</p> <p>아래 코드처럼 useSelector의 두번째 인자에 비교함수를 작성하거나 아래처럼 shallowEqual을 사용하는것이다.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> email <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span>
  <span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> state<span class="token punctuation">.</span>user<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    <span class="token literal-property property">email</span><span class="token operator">:</span> state<span class="token punctuation">.</span>user<span class="token punctuation">.</span>email
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  shallowEqual
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>둘다 react-redux 패키지에 포함되어있다.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/fe/react-tutorial.html" class="prev">React Tutorial</a></span> <span class="next"><a href="/fe/rxjs.html">RxJS</a>
      →
    </span></p></div>  <div id="comment-wrap"><script src="https://utteranc.es/client.js" repo="jewelism/jewelism.github.io" issue-term="React" theme="github-light" crossorigin="anonymous" async="async"></script></div></main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.d8edd250.js" defer></script><script src="/assets/js/2.b813d316.js" defer></script><script src="/assets/js/1.63ec6906.js" defer></script><script src="/assets/js/73.58f68dab.js" defer></script>
  </body>
</html>
